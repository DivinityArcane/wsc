var Chatterbox={};Chatterbox.VERSION="0.5.39";Chatterbox.STATE="beta";Chatterbox.UI=function(a,b,e,c){this.events=c||new EventEmitter();this.mozilla=e;this.settings={themes:["wsct_default","wsct_dAmn"],theme:"wsct_default",monitor:["~Monitor",true],username:"",domain:"website.com",clock:true};a.extend(this.settings,b);a.append('<div class="wsc '+this.settings.theme+'"></div>');this.view=a.find(".wsc");this.mns=this.format_ns(this.settings.monitor[0]);this.lun=this.settings.username.toLowerCase();this.monitoro=null;this.swidth=(function(){if($.browser.msie){var j=$('<textarea cols="10" rows="2"></textarea>').css({position:"absolute",top:-1000,left:-1000}).appendTo("body"),h=$('<textarea cols="10" rows="2" style="overflow: hidden;"></textarea>').css({position:"absolute",top:-1000,left:-1000}).appendTo("body");scrollbarWidth=j.width()-h.width();j.add(h).remove()}else{var g=$("<div />").css({width:100,height:100,overflow:"auto",position:"absolute",top:-1000,left:-1000}).prependTo("body").append("<div />").find("div").css({width:"100%",height:200});
scrollbarWidth=100-g.width();g.parent().remove()}return scrollbarWidth})();this.LIB="Chatterbox";this.VERSION=Chatterbox.VERSION;this.STATE=Chatterbox.STATE};wsc.defaults.UI=Chatterbox.UI;Chatterbox.UI.prototype.trigger=function(a,b){this.events.emit(a,b,this)};Chatterbox.UI.prototype.on=function(b,a){this.events.addListener(b,a)};Chatterbox.UI.prototype.remove_listeners=function(){this.events.removeListeners()};Chatterbox.UI.prototype.deform_ns=function(a){if(a.indexOf("chat:")==0){return"#"+a.slice(5)}if(a.indexOf("server:")==0){return"~"+a.slice(7)}if(a.indexOf("pchat:")==0){var b=a.split(":");b.shift();for(i in b){name=b[i];if(name.toLowerCase()!=this.lun){return"@"+name}}}if(a.indexOf("login:")==0){return"@"+a.slice(6)}if(a[0]!="#"&&a[0]!="@"&&a[0]!="~"){return"#"+a}return a};Chatterbox.UI.prototype.format_ns=function(a){if(a.indexOf("#")==0){return"chat:"+a.slice(1)}if(a.indexOf("@")==0){var b=[a.slice(1),this.lun];b.sort(caseInsensitiveSort);b.unshift("pchat");return b.join(":")}if(a.indexOf("~")==0){return"server:"+a.slice(1)
}if(a.indexOf("chat:")!=0&&a.indexOf("server:")!=0&&a.indexOf("pchat:")!=0){return"chat:"+a}return a};Chatterbox.UI.prototype.set_events=function(a){this.events=a||this.events};Chatterbox.UI.prototype.clock=function(a){if(a===undefined||a==this.settings.clock){return this.settings.clock}this.settings.clock=a;this.chatbook.retime();return this.settings.clock};Chatterbox.UI.prototype.build=function(c,a,b){this.view.append(Chatterbox.template.ui);this.control=new (c||Chatterbox.Control)(this);this.nav=new (a||Chatterbox.Navigation)(this);this.chatbook=new (b||Chatterbox.Chatbook)(this);hide=this.settings.monitor[1];this.monitoro=this.chatbook.create_channel(this.mns,hide,true);this.control.focus()};Chatterbox.UI.prototype.resize=function(){this.control.resize();this.view.height(this.view.parent().height());this.nav.resize();this.chatbook.resize(this.view.parent().height()-this.nav.height()-this.control.height())};Chatterbox.UI.prototype.loop=function(){this.chatbook.loop()};Chatterbox.UI.prototype.create_channel=function(b,a){this.chatbook.create_channel(b,a)
};Chatterbox.UI.prototype.remove_channel=function(a){this.chatbook.remove_channel(a)};Chatterbox.UI.prototype.toggle_channel=function(a){return this.chatbook.toggle_channel(a)};Chatterbox.UI.prototype.channel=function(a,b){return this.chatbook.channel(a,b)};Chatterbox.UI.prototype.channels=function(){return this.chatbook.channels()};Chatterbox.UI.prototype.channel_left=function(){this.chatbook.channel_left()};Chatterbox.UI.prototype.channel_right=function(){this.chatbook.channel_right()};Chatterbox.UI.prototype.monitor=function(b,a){this.monitoro.server_message(b,a)};Chatterbox.UI.prototype.server_message=function(b,a){this.chatbook.server_message(b,a)};Chatterbox.UI.prototype.log_item=function(a){this.chatbook.log_item(a)};Chatterbox.UI.prototype.log=function(a){this.chatbook.log_item(wsc_html_logmsg.replacePArg("{message}",a))};Chatterbox.UI.prototype.theme=function(a){if(this.settings.theme==a){return}if(this.settings.themes.indexOf(a)==-1){a="wsct_"+a;if(this.settings.themes.indexOf(a)==-1){return
}}this.view.removeClass(this.settings.theme).addClass(a);this.settings.theme=a};Chatterbox.UI.prototype.add_theme=function(a){if(this.settings.themes.indexOf(a)>-1){return}this.settings.themes.push(a)};Chatterbox.Channel=function(g,c,e,b){var a=g.deform_ns(c).slice(1).toLowerCase();this.manager=g;this.hidden=e;this.monitor=b||false;this.built=false;this.selector=a;this.raw=g.format_ns(c);this.namespace=g.deform_ns(c)};Chatterbox.Channel.prototype.build=function(){if(this.built){return}var a=this.selector;ns=this.namespace;this.tab=this.manager.nav.add_tab(a,ns);this.tabl=this.tab.find(".tab");this.tabc=this.tab.find(".close");this.manager.chatbook.view.append(Chatterbox.render("channel",{selector:a,ns:ns}));this.window=this.manager.chatbook.view.find("#"+a+"-window");this.logpanel=this.window.find("#"+a+"-log");this.wrap=this.logpanel.find("ul.logwrap");this.userpanel=this.window.find("#"+a+"-users");var c=this;this.tabl.click(function(){c.manager.toggle_channel(a);return false});this.tabc.click(function(g){c.manager.trigger("tab.close.clicked",{ns:c.namespace,chan:c,e:g});
return false});var b=true;this.window.click(function(g){if(b){c.manager.control.focus()}else{b=true}});this.logpanel.select(function(){b=false});if(this.hidden){this.tab.toggleClass("hidden")}this.built=true};Chatterbox.Channel.prototype.hide=function(){this.window.css({display:"none"});this.tab.removeClass("active")};Chatterbox.Channel.prototype.show=function(){this.window.css({display:"block"});this.tab.addClass("active");this.tab.removeClass("noise tabbed fill");this.resize()};Chatterbox.Channel.prototype.remove=function(){this.tab.remove();this.window.remove()};Chatterbox.Channel.prototype.scroll=function(){this.pad();var a=this.wrap.prop("scrollWidth")-this.wrap.innerWidth();var b=this.wrap.prop("scrollHeight")-this.wrap.innerHeight();this.wrap.scrollTop(b+(a>0?this.manager.swidth:0))};Chatterbox.Channel.prototype.pad=function(){this.wrap.css({"padding-top":0,height:"auto"});wh=this.wrap.innerHeight();lh=this.logpanel.innerHeight()-this.logpanel.find("header").height()-3;pad=lh-wh;
if(pad>0){this.wrap.css({"padding-top":pad})}else{this.wrap.css({"padding-top":0,height:lh})}};Chatterbox.Channel.prototype.resize=function(){this.wrap.css({"padding-top":0});wh=this.manager.chatbook.height();this.window.height(wh);cw=this.window.width();cu=this.window.find("div.chatusers");title=this.window.find("header div.title");topic=this.window.find("header div.topic");if(cu.css("display")!="none"){cu.width(1);userwidth=cu[0].scrollWidth+this.manager.swidth+5;max=parseInt(cu.css("max-width").slice(0,-2));if(userwidth>max){userwidth=max}cu.width(userwidth);cw=cw-cu.outerWidth()}if(title.css("display")=="block"){wh=wh-title.outerHeight(true)}this.logpanel.css({height:wh-3,width:cw-3});this.scroll();cu.css({height:this.logpanel.innerHeight()})};Chatterbox.Channel.prototype.loop=function(){msgs=this.logpanel.find(".logmsg");if(msgs.length<200){return}msgs.slice(0,msgs.length-200).remove();this.resize()};Chatterbox.Channel.prototype.log=function(a){data={ns:this.namespace,message:a};this.manager.trigger("log.before",data);
this.log_item(Chatterbox.render("logmsg",{message:data.message}))};Chatterbox.Channel.prototype.log_item=function(b){var a=new Date();ts="";if(this.manager.settings.clock){ts=formatTime("{HH}:{mm}:{ss}",a)}else{ts=formatTime("{hh}:{mm}:{ss} {mr}",a)}data={ts:ts,ms:a.getTime(),message:b};this.manager.trigger("log_item.before",data);this.wrap.append(Chatterbox.render("logitem",data));this.manager.trigger("log_item.after",{item:this.wrap.find("li").last()});this.scroll();this.noise()};Chatterbox.Channel.prototype.retime=function(){var a="";var b=this.wrap;if(this.manager.settings.clock){a="{HH}:{mm}:{ss}"}else{a="{hh}:{mm}:{ss} {mr}"}b.find("span.ts").each(function(c,e){el=b.find(e);time=new Date(parseInt(el.prop("id")));el.text(formatTime(a,time))})};Chatterbox.Channel.prototype.server_message=function(b,a){data={ns:this.namespace,message:b,info:a};this.manager.trigger("server_message.before",data);this.log_item(Chatterbox.render("servermsg",{message:data.message,info:data.info}))};Chatterbox.Channel.prototype.clear=function(){this.logpanel.find("li.logmsg").remove();
this.logpanel.find("li.loginfo").remove();this.wrap.height(0);this.resize()};Chatterbox.Channel.prototype.log_info=function(g,e){data={ns:this.namespace,ref:g,content:e};this.manager.trigger("log_info.before",data);delete data.ns;var a=this.wrap.append(Chatterbox.render("loginfobox",data));this.scroll();var h=this;var c=this.wrap.find("li."+data.ref);c.find("a.close").click(function(b){h.wrap.find(this).parent().remove();h.resize();return false});return c};Chatterbox.Channel.prototype.log_whois=function(k){var e={avatar:'<a href="#"><img height="50" width="50" alt="avatar"/></a>',username:"<b>"+k.symbol+k.username+"</b>",info:[],conns:[],raw:k,};for(var l in k.connections){var j=k.connections[l];var p=[];if(j.online){stamp=(new Date-(j.online*1000));p.push(["online",DateStamp(stamp/1000)+formatTime(" [{HH}:{mm}:{ss}]",new Date(stamp))])}if(j.idle){p.push(["idle",timeLengthString(j.idle)])}if(j.agent){p.push(["agent",j.agent])}if(j.debug){p.push(["debug",j.debug])}p.push(["chatrooms",j.channels.join(" ")]);
e.conns.push(p)}this.manager.trigger("log_whois.before",e);var a="";for(var l in e.conns){var h=e.conns[l];var q='<section class="conn"><p><em>connection '+((parseInt(l)+1).toString())+":</em></p>";q+="<ul>";for(x in h){q+="<li><strong>"+h[x][0]+":</strong> "+h[x][1]+"</li>"}q+="</ul>";a+=q+"</section>"}var g="";for(var l in e.info){g+="<li>"+e.info[l]+"</li>"}var m=this.log_info("whois-"+k.username,Chatterbox.render("whoiswrap",{avatar:e.avatar,info:Chatterbox.render("whoisinfo",{username:e.username,info:g,connections:a})}));var c=m.find("div.avatar");var b=m.find("div.info");b.width(m.find(".whoiswrap").width()-100);c.height(m.height()-10);this.scroll()};Chatterbox.Channel.prototype.log_pc=function(e,g){contents="";for(var c in g){if(!g.hasOwnProperty(c)){continue}var b=g[c];var a="";if(b[2].length==0){a="<em>"+(e?"default privileges":"no members")+"</em>"}else{a=b[2]}contents+=String.format("<li><em>{0}</em> <strong>{1}</strong>:<ul><li>{2}</li></ul></li>",[b[1],b[0],a])}var h={title:"Privilege class "+(e?"permissions":"members"),info:"<ul>"+contents+"</ul>"};
this.log_info("pc-"+(e?"permissions":"members"),Chatterbox.render("pcinfo",h))};Chatterbox.Channel.prototype.set_header=function(a,b){headd=this.window.find("header div."+a);headd.replaceWith(Chatterbox.render("header",{head:a,content:b||""}));headd=this.window.find("header div."+a);if(b){headd.css({display:"block"})}else{this.window.find("header div."+a).css({display:"none"})}this.resize()};Chatterbox.Channel.prototype.get_header=function(a){return this.window.find("header div."+a)};Chatterbox.Channel.prototype.set_user_list=function(a){if(Object.size(a)==0){return}infoboxes=[];html="";for(order in a){pc=a[order];html+='<div class="pc"><h3>'+pc.name+"</h3><ul>";for(un in pc.users){user=pc.users[un];conn=user.conn==1?"":"["+user.conn+"]";html+='<li><a target="_blank" id="'+user.name+'" href="http://'+user.name+"."+this.manager.settings.domain+'"><em>'+user.symbol+"</em>"+user.name+"</a>"+conn+"</li>";if(user.hover){infoboxes.push(user.hover)}}html+="</ul></div>"}this.window.find("div.chatusers").html(html);
this.userpanel=this.window.find("div.chatusers");this.userpanel.css({display:"block"});for(index in infoboxes){this.userinfo(infoboxes[index])}this.resize()};Chatterbox.Channel.prototype.highlight=function(c){var a=this.tab;(c||this.window.find(".logmsg").last()).addClass("highlight");if(a.hasClass("active")){return}if(a.hasClass("tabbed")){return}var e=0;a.addClass("tabbed");function b(){e++;a.toggleClass("fill");if(e==6){return}setTimeout(b,1000)}b()};Chatterbox.Channel.prototype.noise=function(){if(!this.tab.hasClass("active")){this.tab.addClass("noise")}};Chatterbox.Channel.prototype.userinfo=function(a){var c=this.window.find("a#"+a.name);if(c.length==0){return}var e=this;var b=null;c.hover(function(g){a.info=[];ed={ns:e.namespace,user:a};e.manager.trigger("userinfo.before",ed);a=ed.user;infoli="";for(index in a.info){infoli+="<li>"+a.info[index]+"</li>"}e.window.append(Chatterbox.render("userinfo",{username:a.name,avatar:a.avatar,link:a.link,info:infoli}));b=e.window.find(".userinfo#"+a.name);
e.window.find("div.userinfo:not('#"+a.name+"')").remove();pos=c.offset();b.css({top:(pos.top-c.height())+10,left:(pos.left-(b.width()))-6});b.find(".info").height(b.height());b.hover(function(){b.data("hover",1)},function(h){b.data("hover",0);e.unhover_user(b,h)});b.data("hover",0)},function(g){c.data("hover",0);e.unhover_user(b,g)})};Chatterbox.Channel.prototype.unhover_user=function(b,a){o=b.offset();eb=b.outerHeight(true)+o.top;er=b.outerWidth(true)+o.left;x=a.pageX;y=a.pageY;if(x>o.left&&x<er&&y>o.top&&y<eb){return}if(x<(er+15)&&x>o.left&&y>o.top&&y<(o.top+15)){return}b.remove()};Chatterbox.Chatbook=function(a){this.manager=a;this.view=this.manager.view.find("div.chatbook");this.chan={};this.trail=[];this.current=null;this.manager.on("tab.close.clicked",function(b,c){c.chatbook.remove_channel(b.ns)})};Chatterbox.Chatbook.prototype.height=function(){return this.view.height()};Chatterbox.Chatbook.prototype.resize=function(a){a=a||600;this.view.height(a);for(select in this.chan){var b=this.chan[select];
b.resize()}};Chatterbox.Chatbook.prototype.loop=function(){for(select in this.chan){this.chan[select].loop()}};Chatterbox.Chatbook.prototype.channel=function(a,b){a=this.manager.deform_ns(a).slice(1).toLowerCase();if(!this.chan[a]&&b){this.chan[a]=b}return this.chan[a]};Chatterbox.Chatbook.prototype.channels=function(){chans=-1;for(ns in this.chan){if(this.chan[ns].hidden){continue}chans++}return chans};Chatterbox.Chatbook.prototype.create_channel=function(b,c,a){chan=this.channel(b,this.channel_object(b,c,a));chan.build();this.toggle_channel(b);this.manager.resize();return chan};Chatterbox.Chatbook.prototype.channel_object=function(a,b){return new Chatterbox.Channel(this.manager,a,b)};Chatterbox.Chatbook.prototype.toggle_channel=function(a){var c=this.channel(a);var b=c;if(!c){return}if(this.current){if(this.current==c){return}this.current.hide();b=this.current}c.show();this.manager.control.focus();this.current=c;this.manager.resize();if(this.trail.indexOf(c.namespace)==-1){this.trail.push(c.namespace)
}this.manager.trigger("channel.selected",{ns:c.namespace,chan:c,prev:b})};Chatterbox.Chatbook.prototype.remove_channel=function(a){if(this.channels()==0){return}var b=this.channel(a);b.remove();delete this.chan[b.selector];if(this.current==b){this.channel_left()}rpos=this.trail.indexOf(b.namespace);this.trail.splice(rpos,1)};Chatterbox.Chatbook.prototype.channel_left=function(){var b=this.current.namespace;var a=this.trail.indexOf(b);if(a<0){return}var e=null;while(true){try{e=this.channel(this.trail[--a])}catch(c){a=this.trail.length-1;e=this.channel(this.trail[a])}if(!e.hidden){break}}this.toggle_channel(e.namespace)};Chatterbox.Chatbook.prototype.channel_right=function(){var b=this.current.namespace;var a=this.trail.indexOf(b);if(a==-1){return}var e=null;while(true){try{e=this.channel(this.trail[++a])}catch(c){a=0;e=this.channel(this.trail[0])}if(!e.hidden){break}}this.toggle_channel(e.namespace)};Chatterbox.Chatbook.prototype.server_message=function(b,a){for(ns in this.chan){this.chan[ns].server_message(b,a)
}};Chatterbox.Chatbook.prototype.log_item=function(a){for(ns in this.chan){this.chan[ns].log_item(a)}};Chatterbox.Chatbook.prototype.retime=function(){for(ns in this.chan){this.chan[ns].retime()}};Chatterbox.Control=function(b){this.manager=b;this.manager.view.append(Chatterbox.template.control);this.view=this.manager.view.find("div.chatcontrol");this.form=this.view.find("form.msg");this.input=this.form.find("input.msg");this.mli=this.form.find("textarea.msg");this.ci=this.input;this.ml=false;this.mlb=this.view.find("a[href~=#multiline].button");var a=this;this.mlb.click(function(c){a.multiline(!a.multiline());return false})};Chatterbox.Control.prototype.focus=function(){this.ci.focus()};Chatterbox.Control.prototype.resize=function(){w=this.manager.view.width();this.view.css({width:"100%"});this.form.css({width:this.manager.view.width()-20});this.input.css({width:this.manager.view.width()-100});this.mli.css({width:this.manager.view.width()-90})};Chatterbox.Control.prototype.height=function(){return this.view.height()
};Chatterbox.Control.prototype.set_handlers=function(b,a){if(this.manager.mozilla){this.input.keypress(b||this._onkeypress);this.mli.keypress(b||this._onkeypress)}else{this.input.keydown(b||this._onkeypress);this.mli.keydown(b||this._onkeypress)}this.form.submit(a||this._onsubmit)};Chatterbox.Control.prototype.multiline=function(a){if(a==undefined||this.ml==a){return this.ml}this.ml=a;if(this.ml){this.input.css("display","none");this.mli.css("display","inline-block");this.ci=this.mli;this.manager.resize();return this.ml}this.mli.css("display","none");this.input.css("display","inline-block");this.ci=this.input;this.manager.resize();return this.mli};Chatterbox.Control.prototype._onkeypress=function(a){};Chatterbox.Control.prototype._onsubmit=function(a){};Chatterbox.Control.prototype.chomp=function(){d=this.ci.val();i=d.lastIndexOf(" ");if(i==-1){this.ci.val("");return d}chunk=d.slice(i+1);this.ci.val(d.slice(0,i));if(chunk.length==0){return this.chomp()}return chunk};Chatterbox.Control.prototype.unchomp=function(a){d=this.ci.val();
if(!d){this.ci.val(a)}else{this.ci.val(d+" "+a)}};Chatterbox.Control.prototype.get_text=function(a){if(a==undefined){return this.ci.val()}this.ci.val(a||"");return this.ci.val()};Chatterbox.Control.prototype.set_text=function(a){this.ci.val(a||"")};Chatterbox.Navigation=function(a){this.manager=a;this.nav=this.manager.view.find("nav.tabs");this.tabs=this.nav.find("#chattabs");this.buttons=this.nav.find("#tabnav");this.tableft=this.buttons.find(".arrow_left");this.tabright=this.buttons.find(".arrow_right");this.settingsb=this.buttons.find("#settings-button");this.settings={};this.settings.open=false;this.showclose=true;var b=this;this.settingsb.click(function(e){if(b.settings.open){return false}var c={e:e,settings:new Chatterbox.Settings.Config()};b.manager.trigger("settings.open",c);b.manager.trigger("settings.open.ran",c);about=c.settings.page("About",true);about.item("text",{ref:"about-chatterbox",wclass:"centered faint",text:'Using <a href="http://github.com/photofroggy/wsc/">Chatterbox</a> version '+Chatterbox.VERSION+" "+Chatterbox.STATE+' by ~<a href="http://photofroggy.deviantart.com/">photofroggy</a>.'});
b.settings.window=new Chatterbox.Settings(b.manager,c.settings);b.settings.window.build();b.settings.open=true;return false});this.tableft.click(function(){b.manager.channel_left();return false});this.tabright.click(function(){b.manager.channel_right();return false})};Chatterbox.Navigation.prototype.height=function(){return this.nav.height()};Chatterbox.Navigation.prototype.add_tab=function(a,b){this.tabs.append(Chatterbox.render("tab",{selector:a,ns:b}));return this.tabs.find("#"+a+"-tab")};Chatterbox.Navigation.prototype.resize=function(){this.tabs.width(this.nav.width()-this.buttons.outerWidth()-20);if(this.settings.open){this.settings.window.resize()}};Chatterbox.Navigation.prototype.closer=function(a){if(a==undefined||a==this.showclose){return this.showclose}this.showclose=a;if(this.showclose){if(!this.tabs.hasClass("hc")){return}this.tabs.removeClass("hc");return}if(this.tabs.hasClass("hc")){return}this.tabs.addClass("hc")};Chatterbox.Popup=function(b,a){this.manager=b;this.window=null;
this.closeb=null;this.options=Object.extend({ref:"popup",title:"Popup",close:true,content:""},(a||{}))};Chatterbox.Popup.prototype.build=function(){var b={ref:this.options.ref,title:this.options.title,content:this.options.content};if(this.options.close){b.title+='<a href="#close" class="button close medium iconic x"></a>'}this.manager.view.append(Chatterbox.render("popup",b));this.window=this.manager.view.find(".floater."+b.ref);if(this.options.close){this.closeb=this.window.find("a.close");var a=this;this.closeb.click(function(c){a.close();return false})}};Chatterbox.Popup.prototype.close=function(){this.window.remove()};Chatterbox.Settings=function(b,a){Chatterbox.Popup.call(this,b,{ref:"settings",title:"Settings",close:false,content:""});this.config=a;this.saveb=null;this.scb=null;this.tabs=null;this.book=null;this.changed=false};Chatterbox.Settings.prototype=new Chatterbox.Popup();Chatterbox.Settings.prototype.constructor=Chatterbox.Settings;Chatterbox.Settings.prototype.build=function(){this.options.content=Chatterbox.template.settings.main;
Chatterbox.Popup.prototype.build.call(this);this.saveb=this.window.find("a.button.save");this.closeb=this.window.find("a.close");this.scb=this.window.find("a.button.saveclose");this.tabs=this.window.find("nav.tabs ul.tabs");this.book=this.window.find("div.book");this.config.build(this);this.window.find("ul.tabs li").first().addClass("active");this.window.find("div.book div.page").first().addClass("active");var a=this;this.window.find("form").bind("change",function(){a.changed=true});this.saveb.click(function(b){a.save();return false});this.closeb.click(function(b){if(a.changed){if(!confirm("Are you sure? You will lose any unsaved changes.")){return false}}a.close();return false});this.scb.click(function(b){a.save();a.close();return false});this.resize()};Chatterbox.Settings.prototype.resize=function(){inner=this.window.find(".inner");head=inner.find("h2");wrap=inner.find(".bookwrap");foot=inner.find("footer");wrap.height(inner.height()-foot.outerHeight()-head.outerHeight()-15);this.book.height(wrap.innerHeight()-this.tabs.outerHeight()-25);
this.config.resize()};Chatterbox.Settings.prototype.switch_page=function(a){active=this.tabs.find("li.active").first();activeref=active.prop("id").split("-",1)[0];active=this.config.page(activeref.split("_").join(" "));active.hide();a.show()};Chatterbox.Settings.prototype.save=function(){this.config.save(this);this.changed=false};Chatterbox.Settings.prototype.close=function(){this.window.remove();this.manager.nav.settings.open=false;this.manager.nav.settings.window=null;this.config.close(this)};Chatterbox.Settings.Config=function(){this.pages=[]};Chatterbox.Settings.Config.prototype.find_page=function(a){n=a.toLowerCase();for(index in this.pages){page=this.pages[index];if(page.lname==n){return page}}return null};Chatterbox.Settings.Config.prototype.build=function(a){for(i in this.pages){this.pages[i].build(a)}};Chatterbox.Settings.Config.prototype.resize=function(){for(i in this.pages){this.pages[i].resize()}};Chatterbox.Settings.Config.prototype.page=function(b,a){page=this.find_page(b);
a=a||false;if(page==null){page=new Chatterbox.Settings.Page(b);if(a){this.pages.push(page)}else{this.pages.unshift(page)}}return page};Chatterbox.Settings.Config.prototype.save=function(a){for(i in this.pages){this.pages[i].save(a)}};Chatterbox.Settings.Config.prototype.close=function(a){for(i in this.pages){this.pages[i].close(a)}};Chatterbox.Settings.Page=function(a){this.name=a;this.lname=a.toLowerCase();this.ref=replaceAll(this.lname," ","_");this.items=[]};Chatterbox.Settings.Page.prototype.build=function(a){tab=replaceAll(Chatterbox.template.settings.tab,"{ref}",this.ref);tab=replaceAll(tab,"{name}",this.name);b=replaceAll(Chatterbox.template.settings.page,"{ref}",this.ref);b=replaceAll(b,"{page-name}",this.name);a.tabs.append(tab);a.book.append(b);this.view=a.book.find("div#"+this.ref+"-page");this.tab=a.tabs.find("li#"+this.ref+"-tab");var b=this;this.tab.find("a").click(function(c){if(b.tab.hasClass("active")){return false}a.switch_page(b);return false});this.content()};Chatterbox.Settings.Page.prototype.content=function(){for(i in this.items){this.items[i].build(this.view)
}};Chatterbox.Settings.Page.prototype.resize=function(){for(i in this.items){this.items[i].resize()}};Chatterbox.Settings.Page.prototype.show=function(){if(!this.tab.hasClass("active")){this.tab.addClass("active")}if(!this.view.hasClass("active")){this.view.addClass("active")}};Chatterbox.Settings.Page.prototype.hide=function(){if(this.tab.hasClass("active")){this.tab.removeClass("active")}if(this.view.hasClass("active")){this.view.removeClass("active")}};Chatterbox.Settings.Page.prototype.item=function(c,b,a){a=a||false;item=Chatterbox.Settings.Item.get(c,b);if(a){this.items.unshift(item)}else{this.items.push(item)}return item};Chatterbox.Settings.Page.prototype.save=function(a){for(i in this.items){this.items[i].save(a,this)}};Chatterbox.Settings.Page.prototype.close=function(a){for(i in this.items){this.items[i].close(a,this)}};Chatterbox.Settings.Item=function(b,a){this.options=a||{};this.type=b||"base";this.selector=this.type.toLowerCase();this.items=[];this.view=null};Chatterbox.Settings.Item.prototype.build=function(a){if(!this.options.hasOwnProperty("ref")){return
}content=this.content();if(content.length==0){return}wclass="";if(this.options.hasOwnProperty("wclass")){wclass=" "+this.options.wclass}item=Chatterbox.render("settings.item.wrap",{type:this.type.toLowerCase().split(".").join("-"),ref:this.options.ref,"class":wclass});item=replaceAll(item,"{content}",content);a.append(item);this.view=a.find(".item."+this.options.ref);this.hooks(this.view);if(!this.options.hasOwnProperty("subitems")){return}for(i in this.options.subitems){iopt=this.options.subitems[i];type=iopt[0];options=iopt[1];sitem=Chatterbox.Settings.Item.get(type,options);cls=["stacked"];if(sitem.options.wclass){cls.push(sitem.options.wclass)}sitem.options.wclass=cls.join(" ");sitem.build(this.view);this.items.push(sitem)}};Chatterbox.Settings.Item.prototype.content=function(){return Chatterbox.render("settings.item."+this.selector,this.options)};Chatterbox.Settings.Item.prototype.resize=function(){for(i in this.items){this.items[i].resize()}};Chatterbox.Settings.Item.prototype.hooks=function(b){if(!this.options.hasOwnProperty("event")){return
}var a=this.options.event;var c=Chatterbox.template.settings.item.get(this.selector);if(c==false){return}if(!c.hasOwnProperty("events")){return}for(i in c.events){pair=c.events[i];if(!a.hasOwnProperty(pair[0])){continue}b.find(pair[1]).bind(pair[0],a[pair[0]])}};Chatterbox.Settings.Item.prototype._event_stub=function(){};Chatterbox.Settings.Item.prototype._get_cb=function(a){if(!this.options.hasOwnProperty("event")){return this._event_stub}return this.options.event[a]||this._event_stub};Chatterbox.Settings.Item.prototype._get_ep=function(a){var b=Chatterbox.template.settings.item.get(this.selector);if(b==null){return false}if(!b.hasOwnProperty("events")){return false}for(i in b.events){pair=b.events[i];if(pair[0]==a){return pair}}};Chatterbox.Settings.Item.prototype.save=function(c,e){var g=this._get_ep("inspect");var b=g==false?null:this.view.find(g[1]);var a=this._get_cb("save");if(typeof a=="function"){a({input:b,item:this,page:e,window:c})}else{for(i in a){var h=b.hasOwnProperty("slice")?b.slice(i,1):b;
a[i]({input:h,item:this,page:e,window:c})}}for(i in this.items){this.items[i].save(c,e)}};Chatterbox.Settings.Item.prototype.close=function(a,b){pair=this._get_ep("inspect");inps=pair==false?null:this.view.find(pair[1]);cb=this._get_cb("close");if(typeof cb=="function"){cb({input:inps,item:this,page:b,window:a});return}for(i in cb){sinps=inps.hasOwnProperty("slice")?inps.slice(i,1):inps;cb[i]({input:sinps,item:this,page:b,window:a})}for(i in this.items){this.items[i].close(a,b)}};Chatterbox.Settings.Item.get=function(c,b,e,a){types=c.split(".");item=e||Chatterbox.Settings.Item;for(i in types){cls=types[i];if(!item.hasOwnProperty(cls)){item=a||Chatterbox.Settings.Item;break}item=item[cls]}return new item(c,b)};Chatterbox.Settings.Item.Form=function(b,a){Chatterbox.Settings.Item.call(this,b,a);this.form=null;this.fields=[];this.lsection=null;this.fsection=null};Chatterbox.Settings.Item.Form.prototype=new Chatterbox.Settings.Item();Chatterbox.Settings.Item.Form.prototype.constructor=Chatterbox.Settings.Item.Form;
Chatterbox.Settings.Item.Form.field=function(b,a){return Chatterbox.Settings.Item.get(b,a,Chatterbox.Settings.Item.Form,Chatterbox.Settings.Item.Form.Field)};Chatterbox.Settings.Item.Form.prototype.build=function(b){Chatterbox.Settings.Item.prototype.build.call(this,b);if(this.view==null){return}this.lsection=this.view.find("section.labels");this.fsection=this.view.find("section.fields");if(!this.options.hasOwnProperty("fields")){return}for(i in this.options.fields){f=this.options.fields[i];field=Chatterbox.Settings.Item.Form.field(f[0],f[1]);this.fields.push(field);field.build(this)}this.form=this.view.find("form");var a=this;this.form.bind("change",function(c){a.change()})};Chatterbox.Settings.Item.Form.prototype.resize=function(){for(i in this.fields){this.fields[i].resize()}};Chatterbox.Settings.Item.Form.prototype.change=function(){data={};for(i in this.fields){field=this.fields[i];data[field.ref]=field.get()}cb=this._get_cb("change");if(typeof cb=="function"){cb({data:data,form:this})
}else{for(i in cb){cb[i]({data:data,form:this})}}};Chatterbox.Settings.Item.Form.prototype.save=function(a,c){var b={};for(i in this.fields){field=this.fields[i];b[field.ref]=field.get()}cb=this._get_cb("save");if(typeof cb=="function"){cb({data:b,form:this,page:c,window:a})}else{for(i in cb){cb[i]({data:b,form:this,page:c,window:a})}}};Chatterbox.Settings.Item.Form.prototype.close=function(a,b){data={};for(i in this.fields){field=this.fields[i];data[field.ref]=field.get()}cb=this._get_cb("close");if(typeof cb=="function"){cb({data:data,form:this,page:b,window:a})}else{for(i in cb){cb[i]({data:data,form:this,page:b,window:a})}}};Chatterbox.Settings.Item.Form.Field=function(b,a){Chatterbox.Settings.Item.call(this,b,a);this.ref=this.options.ref||"ref";this.label=null;this.field=null;this.value=""};Chatterbox.Settings.Item.Form.Field.prototype=new Chatterbox.Settings.Item();Chatterbox.Settings.Item.Form.Field.prototype.constructor=Chatterbox.Settings.Item.Form.Field;Chatterbox.Settings.Item.Form.Field.prototype.build=function(a){a.lsection.append(Chatterbox.render("settings.item.form.label",{ref:this.ref,label:this.options.label||"","class":(this.options["class"]?" "+this.options["class"]:"")}));
this.label=a.lsection.find("label."+this.ref);this.lwrap=a.lsection.find("."+this.ref+".label");a.fsection.append(Chatterbox.render("settings.item.form.field.wrap",{ref:this.ref,field:Chatterbox.render("settings.item.form.field."+this.selector,this.options)}));this.fwrap=a.fsection.find("div."+this.ref+".field");this.field=this.fwrap.find("."+this.ref);this.view=this.fwrap;var b=this;this.value=this.field.val();this.field.bind("change",function(c){b.value=b.view.find(this).val()})};Chatterbox.Settings.Item.Form.Field.prototype.resize=function(){this.lwrap.height(this.field.height())};Chatterbox.Settings.Item.Form.Field.prototype.get=function(){return this.value};Chatterbox.Settings.Item.Form.Radio=function(b,a){a=a||{};a["class"]=(a["class"]?(a["class"]+" "):"")+"box";Chatterbox.Settings.Item.Form.Field.call(this,b,a);this.items={};this.value=""};Chatterbox.Settings.Item.Form.Radio.prototype=new Chatterbox.Settings.Item.Form.Field();Chatterbox.Settings.Item.Form.Radio.prototype.constructor=Chatterbox.Settings.Item.Form.Radio;
Chatterbox.Settings.Item.Form.Radio.prototype.build=function(c){c.lsection.append(Chatterbox.render("settings.item.form.label",{ref:this.ref,label:this.options.label||""}));this.label=c.lsection.find("label."+this.ref);this.lwrap=c.lsection.find("."+this.ref+".label");if(this.options.hasOwnProperty("items")){for(i in this.options.items){var b=this.options.items[i];b.name=this.ref;this.items[b.ref]=""}}c.fsection.append(Chatterbox.render("settings.item.form.field.wrap",{ref:this.ref,field:Chatterbox.render("settings.item.form.field.radio",this.options)}));this.fwrap=c.fsection.find("div."+this.ref+".field");this.field=this.fwrap.find("input:radio");this.value=this.fwrap.find("input[checked]:radio").val();var a=this;this.field.bind("change",function(e){a.value=a.fwrap.find(this).val()})};Chatterbox.Settings.Item.Form.Radio.prototype.resize=function(){this.lwrap.height(this.fwrap.find(".radiobox").height())};Chatterbox.Settings.Item.Form.Radio.prototype.get=function(){return this.value};Chatterbox.Settings.Item.Form.Check=function(b,a){Chatterbox.Settings.Item.Form.Radio.call(this,b,a);
this.value=[]};Chatterbox.Settings.Item.Form.Check.prototype=new Chatterbox.Settings.Item.Form.Radio();Chatterbox.Settings.Item.Form.Check.prototype.constructor=Chatterbox.Settings.Item.Form.Check;Chatterbox.Settings.Item.Form.Check.prototype.build=function(c){c.lsection.append(Chatterbox.render("settings.item.form.label",{ref:this.ref,label:this.options.label||""}));this.label=c.lsection.find("label."+this.ref);this.lwrap=c.lsection.find("."+this.ref+".label");if(this.options.hasOwnProperty("items")){for(i in this.options.items){var b=this.options.items[i];b.name=this.ref;this.items[b.ref]=""}}c.fsection.append(Chatterbox.render("settings.item.form.field.wrap",{ref:this.ref,field:Chatterbox.render("settings.item.form.field.check",this.options)}));this.fwrap=c.fsection.find("div."+this.ref+".field");this.field=this.fwrap.find("input:checkbox");var a=this;this.value=[];this.fwrap.find("input[checked]:checkbox").each(function(){a.value.push(a.fwrap.find(this).val())});this.field.bind("change",function(e){a.value=[];
a.fwrap.find("input[checked]:checkbox").each(function(){a.value.push(a.fwrap.find(this).val())})})};Chatterbox.Settings.Item.Form.Check.prototype.resize=function(){this.lwrap.height(this.fwrap.find(".checkbox").height())};Chatterbox.Settings.Item.Radio=function(b,a){Chatterbox.Settings.Item.call(this,b,a);this.value=""};Chatterbox.Settings.Item.Radio.prototype=new Chatterbox.Settings.Item();Chatterbox.Settings.Item.Radio.prototype.constructor=Chatterbox.Settings.Item.Radio;Chatterbox.Settings.Item.Radio.prototype.build=function(c){if(this.options.hasOwnProperty("items")){for(i in this.options.items){var b=this.options.items[i];b.name=this.options.ref||"ref"}}Chatterbox.Settings.Item.prototype.build.call(this,c);this.field=this.view.find("input:radio");this.value=this.view.find("input[checked]:radio").val();var a=this;this.field.bind("change",function(e){a.value=a.view.find(this).val()})};Chatterbox.Settings.Item.Check=function(b,a){Chatterbox.Settings.Item.Radio.call(this,b,a);this.value=[]
};Chatterbox.Settings.Item.Check.prototype=new Chatterbox.Settings.Item.Radio();Chatterbox.Settings.Item.Check.prototype.constructor=Chatterbox.Settings.Item.Check;Chatterbox.Settings.Item.Check.prototype.build=function(c){if(this.options.hasOwnProperty("items")){for(i in this.options.items){var b=this.options.items[i];b.name=this.options.ref||"ref"}}Chatterbox.Settings.Item.prototype.build.call(this,c);this.field=this.view.find("input:checkbox");var a=this;this.value=[];this.view.find("input[checked]:checkbox").each(function(){a.value.push(a.view.find(this).val())});this.field.bind("change",function(e){a.value=[];a.view.find("input[checked]:checkbox").each(function(){a.value.push(a.view.find(this).val())})})};Chatterbox.Settings.Item.Form.Field.prototype.get=function(){return this.value};Chatterbox.template={};Chatterbox.render=function(e,h){var c=Chatterbox.template;var b=e.split(".");var g={};var a=null;for(ind in b){part=b[ind];if(!c.hasOwnProperty(part)){return""}c=c[part]}if(c.hasOwnProperty("frame")){a=c;
g=c.render||{};c=c.frame;if(a.hasOwnProperty("pre")){if(typeof a.pre=="function"){c=a.pre(c,h)}else{for(i in a.pre){c=a.pre[i](c,h)}}}}for(key in h){c=replaceAll(c,"{"+key+"}",(g[key]||Chatterbox.template.render_stub)(h[key]||""))}if(a!=null){if(a.hasOwnProperty("post")){if(typeof a.post=="function"){c=a.post(c,h)}else{for(i in a.post){c=a.post[i](c,h)}}}}return c};Chatterbox.template.render_stub=function(a){return a};Chatterbox.template.clean=function(a){return function(b,c){for(i in a){b=replaceAll(b,"{"+a[i]+"}","")}return b}};Chatterbox.template.ui='<nav class="tabs"><ul id="chattabs" class="tabs"></ul>        <ul id="tabnav">            <li><a href="#left" class="button iconic arrow_left"></a></li>            <li><a href="#right" class="button iconic arrow_right"></a></li>            <li><a href="#settings" title="Change client settings" class="button iconic cog" id="settings-button"></a></li>        </ul>        </nav>        <div class="chatbook"></div>';Chatterbox.template.control='<div class="chatcontrol">            <p><a href="#multiline" title="Toggle multiline input" class="button iconic list"></a></p>            <form class="msg">                <input type="text" class="msg" />                <textarea class="msg"></textarea>                <input type="submit" value="Send" class="sendmsg" />            </form>        </div>';
Chatterbox.template.tab='<li id="{selector}-tab"><a href="#{selector}" class="tab">{ns}<a href="#{selector}" class="close iconic x"></a></a></li>';Chatterbox.template.channel='<div class="chatwindow" id="{selector}-window">                    <header>                        <div class="title"></div>                    </header>                    <div class="chatlog" id="{selector}-log">                        <header>                            <div class="topic"></div>                        </header>                        <ul class="logwrap"></ul>                    </div>                    <div class="chatusers" id="{selector}-users">                </div>            </div>';Chatterbox.template.header='<div class="{head}">{content}</div>';Chatterbox.template.logmsg='<span class="message">{message}</span>';Chatterbox.template.logitem='<li class="logmsg"><span class="ts" id="{ms}">{ts}</span> {message}</li>';Chatterbox.template.servermsg='<span class="servermsg">** {message} * <em>{info}</em></span>';
Chatterbox.template.usermsg='<strong class="user">&lt;{user}&gt;</strong> {message}';Chatterbox.template.userinfo='<div class="userinfo" id="{username}">                            <div class="avatar">                                {avatar}                            </div><div class="info">                            <strong>                            {link}                            </strong>                            <ul>{info}</ul></div>                        </div>';Chatterbox.template.loginfobox='<li class="loginfo {ref}"><a href="#{ref}" class="close iconic x"></a>{content}</li>';Chatterbox.template.whois={};Chatterbox.template.whoiswrap='<div class="whoiswrap">                                <div class="avatar">{avatar}</div>                                <div class="info">{info}</div>                                </div>';Chatterbox.template.whoisinfo="<p>{username}</p><ul>{info}</ul>{connections}";Chatterbox.template.pcinfo='<section class="pcinfo"><strong>{title}</strong>{info}</section>';
Chatterbox.template.popup='<div class="floater {ref}"><div class="inner"><h2>{title}</h2><div class="content">{content}</div></div></div>';Chatterbox.template.settings={};Chatterbox.template.settings.main='<div class="bookwrap">                                <nav class="tabs">                                    <ul class="tabs"></ul>                                </nav>                                <div class="book"></div>                            </div>                            <footer>                                <a href="#save" class="button save">Save</a> <a href="#saveclose" class="button saveclose">Save & Close</a> <a href="#close" class="button close big square iconic x"></a>                            </footer>';Chatterbox.template.settings.page='<div class="page" id="{ref}-page"></div>';Chatterbox.template.settings.tab='<li id="{ref}-tab"><a href="#{ref}" class="tab" id="{ref}-tab">{name}</a></li>';Chatterbox.template.settings.krender={};Chatterbox.template.settings.krender.title=function(a){if(a.length==0){return""
}return"<h3>"+a+"</h3>"};Chatterbox.template.settings.krender.text=function(a){return replaceAll(a,"\n\n","\n</p><p>\n")};Chatterbox.template.settings.krender.dditems=function(a){if(a.length==0){return""}render="";for(i in a){item=a[i];render+='<option value="'+item.value+'"';if(item.selected){render+=' selected="yes"'}render+=">"+item.title+"</option>"}return render};Chatterbox.template.settings.krender.radioitems=function(a){if(a.length==0){return""}render="";labels=[];fields=[];for(i in a){item=a[i];labels.push(Chatterbox.render("settings.item.form.label",{ref:item.value,label:item.title}));ritem='<div class="'+item.value+' field radio"><input class="'+item.value+'" type="radio" name="'+item.name+'" value="'+item.value+'"';if(item.selected){ritem+=' checked="yes"'}fields.push(ritem+" /></div>")}return'<section class="labels">'+labels.join("")+'</section><section class="fields">'+fields.join("")+"</section>"};Chatterbox.template.settings.krender.checkitems=function(a){if(a.length==0){return""
}render="";labels=[];fields=[];for(i in a){item=a[i];if("title" in item){labels.push(Chatterbox.render("settings.item.form.label",{ref:item.value,label:item.title}))}ritem='<div class="'+item.value+' field check"><input class="'+item.value+'" type="checkbox" name="'+item.name+'" value="'+item.value+'"';if(item.selected){ritem+=' checked="yes"'}fields.push(ritem+" /></div>")}if(labels.length>0){render+='<section class="labels">'+labels.join("")+"</section>"}return render+'<section class="fields">'+fields.join("")+"</section>"};Chatterbox.template.settings.item={};Chatterbox.template.settings.item.get=function(a){var c=a.split(".");var b=Chatterbox.template.settings.item;for(i in c){tc=c[i];if(b.hasOwnProperty(tc)){b=b[tc];continue}return null}return b};Chatterbox.template.settings.item.wrap='<section class="item {type} {ref}{class}">                                    {content}                                </section>';Chatterbox.template.settings.item.hint={};Chatterbox.template.settings.item.hint.frame='<aside class="hint">{hint}</aside>{content}';
Chatterbox.template.settings.item.hint.prep=function(a,b){if(!b.hasOwnProperty("hint")){return a}return Chatterbox.render("settings.item.hint",{hint:b.hint,content:a})};Chatterbox.template.settings.item.twopane={};Chatterbox.template.settings.item.twopane.frame='{title}<div class="twopane">                                        <div class="text left">                                            <p>{text}</p>                                        </div>                                        <div class="right">                                            {template}                                        </div>                                    </div>';Chatterbox.template.settings.item.twopane.wrap=function(a,b){if(!b.hasOwnProperty("text")){return a}a=replaceAll(Chatterbox.template.settings.item.twopane.frame,"{template}",replaceAll(a,"{title}",""));return a};Chatterbox.template.settings.item.text={};Chatterbox.template.settings.item.text.pre=Chatterbox.template.settings.item.hint.prep;
Chatterbox.template.settings.item.text.post=Chatterbox.template.clean(["title","text"]);Chatterbox.template.settings.item.text.render={title:Chatterbox.template.settings.krender.title,text:Chatterbox.template.settings.krender.text};Chatterbox.template.settings.item.text.frame="{title}<p>                                        {text}                                    </p>";Chatterbox.template.settings.item.dropdown={};Chatterbox.template.settings.item.dropdown.pre=[Chatterbox.template.settings.item.twopane.wrap,Chatterbox.template.settings.item.hint.prep];Chatterbox.template.settings.item.dropdown.render={title:Chatterbox.template.settings.krender.title,text:Chatterbox.template.settings.krender.text,items:Chatterbox.template.settings.krender.dditems};Chatterbox.template.settings.item.dropdown.post=Chatterbox.template.clean(["title","items"]);Chatterbox.template.settings.item.dropdown.events=[["change","select"],["inspect","select"]];Chatterbox.template.settings.item.dropdown.frame="{title}<form>                                                <select>                                                    {items}                                                </select>                                            </form>";
Chatterbox.template.settings.item.radio={};Chatterbox.template.settings.item.radio.pre=[Chatterbox.template.settings.item.twopane.wrap,Chatterbox.template.settings.item.hint.prep];Chatterbox.template.settings.item.radio.render={title:Chatterbox.template.settings.krender.title,text:Chatterbox.template.settings.krender.text,items:Chatterbox.template.settings.krender.radioitems};Chatterbox.template.settings.item.radio.post=Chatterbox.template.clean(["ref","title","items"]);Chatterbox.template.settings.item.radio.events=[["change","input:radio"],["inspect","input:radio"]];Chatterbox.template.settings.item.radio.frame='{title}<div class="{ref} radiobox"><form>{items}</form></div>';Chatterbox.template.settings.item.check={};Chatterbox.template.settings.item.check.pre=[Chatterbox.template.settings.item.twopane.wrap,Chatterbox.template.settings.item.hint.prep];Chatterbox.template.settings.item.check.render={title:Chatterbox.template.settings.krender.title,text:Chatterbox.template.settings.krender.text,items:Chatterbox.template.settings.krender.checkitems};
Chatterbox.template.settings.item.check.post=Chatterbox.template.clean(["ref","title","items"]);Chatterbox.template.settings.item.check.events=[["change","input:checkbox"],["inspect","input:checkbox"]];Chatterbox.template.settings.item.check.frame='{title}<div class="{ref} checkbox"><form>{items}</form></div>';Chatterbox.template.settings.item.textfield={};Chatterbox.template.settings.item.textfield.pre=[Chatterbox.template.settings.item.twopane.wrap,Chatterbox.template.settings.item.hint.prep];Chatterbox.template.settings.item.textfield.render={title:Chatterbox.template.settings.krender.title,text:Chatterbox.template.settings.krender.text};Chatterbox.template.settings.item.textfield.post=Chatterbox.template.clean(["ref","title","default"]);Chatterbox.template.settings.item.textfield.events=[["blur","input"],["inspect","input"]];Chatterbox.template.settings.item.textfield.frame='{title}<div class="{ref} textfield"><form><input type="text" value="{default}" /></form></div>';Chatterbox.template.settings.item.textarea={};
Chatterbox.template.settings.item.textarea.pre=[Chatterbox.template.settings.item.twopane.wrap,Chatterbox.template.settings.item.hint.prep];Chatterbox.template.settings.item.textarea.render={title:Chatterbox.template.settings.krender.title,text:Chatterbox.template.settings.krender.text};Chatterbox.template.settings.item.textarea.post=Chatterbox.template.clean(["ref","title","default"]);Chatterbox.template.settings.item.textarea.events=[["blur","textarea"],["inspect","textarea"]];Chatterbox.template.settings.item.textarea.frame='{title}<div class="{ref} textarea"><form><textarea rows="4" cols="20" value="{default}"></textarea></form></div>';Chatterbox.template.settings.item.form={};Chatterbox.template.settings.item.form.pre=[Chatterbox.template.settings.item.twopane.wrap,Chatterbox.template.settings.item.hint.prep];Chatterbox.template.settings.item.form.render={title:Chatterbox.template.settings.krender.title,text:Chatterbox.template.settings.krender.text,items:Chatterbox.template.settings.krender.dditems};
Chatterbox.template.settings.item.form.post=Chatterbox.template.clean(["title","text","items"]);Chatterbox.template.settings.item.form.frame='{title}<form>                                                <section class="labels"></section>                                                <section class="fields"></section>                                            </form>';Chatterbox.template.settings.item.form.label={};Chatterbox.template.settings.item.form.label.post=Chatterbox.template.clean(["ref","label","class"]);Chatterbox.template.settings.item.form.label.frame='<div class="{ref} label{class}"><label for="{ref}">{label}</label></div>';Chatterbox.template.settings.item.form.field={};Chatterbox.template.settings.item.form.field.wrap={};Chatterbox.template.settings.item.form.field.wrap.post=Chatterbox.template.clean(["ref","field"]);Chatterbox.template.settings.item.form.field.wrap.frame='<div class="{ref} field">{field}</div>';Chatterbox.template.settings.item.form.field.dropdown={};Chatterbox.template.settings.item.form.field.dropdown.render={items:Chatterbox.template.settings.krender.dditems};
Chatterbox.template.settings.item.form.field.dropdown.post=Chatterbox.template.clean(["ref","items"]);Chatterbox.template.settings.item.form.field.dropdown.frame='<select class="{ref}">{items}</select>';Chatterbox.template.settings.item.form.field.textfield={};Chatterbox.template.settings.item.form.field.textfield.post=Chatterbox.template.clean(["ref","default"]);Chatterbox.template.settings.item.form.field.textfield.frame='<input class="{ref}" type="text" value="{default}" />';Chatterbox.template.settings.item.form.field.textarea={};Chatterbox.template.settings.item.form.field.textarea.post=Chatterbox.template.clean(["ref","default"]);Chatterbox.template.settings.item.form.field.textarea.frame='<textarea class="{ref}" rows="4" cols="20" value="{default}"></textarea>';Chatterbox.template.settings.item.form.field.radio={};Chatterbox.template.settings.item.form.field.radio.render={items:Chatterbox.template.settings.krender.radioitems};Chatterbox.template.settings.item.form.field.radio.post=Chatterbox.template.clean(["ref","items"]);
Chatterbox.template.settings.item.form.field.radio.frame='<div class="{ref} radiobox">{items}</div>';Chatterbox.template.settings.item.form.field.check={};Chatterbox.template.settings.item.form.field.check.render={items:Chatterbox.template.settings.krender.checkitems};Chatterbox.template.settings.item.form.field.check.post=Chatterbox.template.clean(["ref","items"]);Chatterbox.template.settings.item.form.field.check.frame='<div class="{ref} checkbox">{items}</div>';